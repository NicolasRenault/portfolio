---
import Layout from "@layouts/MainLayout.astro";
import { getLangFromUrl, getUrlWithTranslation } from "@utils";
import { astroI18n, t } from "astro-i18n";
import projects from "@data/projects.json";
import contributions from "@data/contributions.json";
import ProjectCard from "@components/ProjectCard.astro";

astroI18n.init(Astro);
const lang = getLangFromUrl(Astro.url);

const years = Object.keys(projects).sort((a, b) => parseInt(b) - parseInt(a));
const contributionsList = Object.keys(contributions);

interface Project {
	name: string;
	description: string;
	url: string;
	createdAt: Date;
	languages: string[];
	year?: number;
	icon?: string;
	pinned?: boolean;
	fork?: string;
}
---

<Layout title={"Projects"}>
	<main>
		<h1 class="text-gradient">Projects</h1>
		{
			years.map((year) => {
				const currentProjects = (projects as any)[year];

				return (
					<>
						<h2>{year}</h2>
						<div id={year}>
							{currentProjects.map((project: Project) => {
								return (
									<ProjectCard
										title={project.name}
										description={t(project.description)}
										icon={project.icon}
										project_link={project.url}
										pinned={project.pinned}
										languages={project.languages}
									/>
								);
							})}
						</div>
					</>
				);
			})
		}

		<h2>Contributions</h2>
		{
			contributionsList.map((contribution) => (
				<ProjectCard
					title={(contributions as any)[contribution].name}
					description={t((contributions as any)[contribution].description)}
					project_link={(contributions as any)[contribution].url}
					languages={(contributions as any)[contribution].languages}
				/>
			))
		}
	</main>

	<style lang="scss" is:global>
		main {
			margin: auto;
			padding: 1.5rem;
			max-width: 60ch;
		}
		h1 {
			font-size: 3rem;
			font-weight: 800;
			margin: 0;
		}
		.text-gradient {
			background-image: var(--accent-gradient);
			background-clip: text;
			-webkit-text-fill-color: transparent;
			background-size: 400%;
			background-position: 0%;
		}
	</style>
</Layout>
